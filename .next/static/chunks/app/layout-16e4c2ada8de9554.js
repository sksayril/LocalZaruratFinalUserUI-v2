(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{2601:function(t,e,n){"use strict";var o,r;t.exports=(null==(o=n.g.process)?void 0:o.env)&&"object"==typeof(null==(r=n.g.process)?void 0:r.env)?n.g.process:n(8960)},6339:function(t,e,n){Promise.resolve().then(n.t.bind(n,8877,23)),Promise.resolve().then(n.bind(n,5806)),Promise.resolve().then(n.bind(n,634)),Promise.resolve().then(n.t.bind(n,7354,23))},164:function(t,e,n){"use strict";n.d(e,{MS:function(){return a},RT:function(){return g},TX:function(){return f},a$:function(){return c},c0:function(){return h},ck:function(){return l},gF:function(){return d},hv:function(){return m},pE:function(){return y},pH:function(){return s},th:function(){return p},ts:function(){return u}});var o=n(2601);let r=o.env.NEXT_PUBLIC_API_BASE_URL||"https://api.localzarurat.com/api";class a extends Error{constructor(t,e,n){super(t),this.status=e,this.code=n,this.name="ApiError"}}async function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n="".concat(r).concat(t),o=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e}),i=await o.json();if(!o.ok)throw new a(i.message||"Request failed with status ".concat(o.status),o.status,i.code);return i}catch(t){if(t instanceof a)throw t;if(t instanceof TypeError&&t.message.includes("fetch"))throw new a("Network error. Please check your connection.",0);throw new a("An unexpected error occurred.",500)}}async function c(t){return i("/auth/register",{method:"POST",body:JSON.stringify(t)})}async function s(t){return i("/auth/login",{method:"POST",body:JSON.stringify(t)})}async function u(t){let e=await i("/auth/me",{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});return e.data}async function l(t,e){let n=await i("/auth/profile",{method:"PUT",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});return n.data}async function f(t){try{await i("/auth/logout",{method:"POST",headers:{Authorization:"Bearer ".concat(t)}})}catch(t){console.warn("Logout API call failed:",t)}}async function d(t){return i("/auth/forgot-password",{method:"POST",body:JSON.stringify(t)})}async function h(t){return i("/auth/reset-password",{method:"POST",body:JSON.stringify(t)})}async function y(){let t=await i("/customer/categories",{method:"GET",next:{revalidate:0}});return t.data}async function m(t){if(!t||""===t.trim())throw new a("Main category ID is required",400);let e=await i("/customer/categories/".concat(t,"/subcategories"),{method:"GET",next:{revalidate:0}});return e.data}async function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(!t||""===t.trim())throw new a("Subcategory ID is required",400);let o=await i("/customer/subcategories/".concat(t,"/vendors?page=").concat(e,"&limit=").concat(n),{method:"GET",next:{revalidate:0}});return{data:o.data,pagination:o.pagination}}async function p(t){if(!t||""===t.trim())throw new a("Vendor ID is required",400);let e=await i("/customer/vendors/".concat(t),{method:"GET",next:{revalidate:0}});return e.data}},5806:function(t,e,n){"use strict";n.r(e),n.d(e,{AuthProvider:function(){return c},useAuth:function(){return s}});var o=n(7437),r=n(2265),a=n(164);let i=(0,r.createContext)(void 0);function c(t){let{children:e}=t,[n,c]=(0,r.useState)(null),[s,u]=(0,r.useState)(null),[l,f]=(0,r.useState)(!0),[d,h]=(0,r.useState)(!1),[y,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{let t=async()=>{try{let t=localStorage.getItem("authToken");if(t){u(t);let e=await (0,a.ts)(t);c(e)}}catch(t){console.warn("Invalid token, clearing auth state:",t),localStorage.removeItem("authToken"),u(null),c(null)}finally{f(!1)}};t()},[]);let g=async(t,e)=>{try{h(!0),m(null);let n=await (0,a.pH)({email:t,password:e});localStorage.setItem("authToken",n.data.token),u(n.data.token),c(n.data.user)}catch(e){let t="Login failed. Please try again.";throw e instanceof a.MS?t=401===e.status?"Invalid email or password.":429===e.status?"Too many login attempts. Please try again later.":0===e.status?"Network error. Please check your connection.":e.message:e instanceof Error&&(t=e.message),m(t),Error(t)}finally{h(!1)}},p=async t=>{try{h(!0),m(null);let e=await (0,a.a$)(t);localStorage.setItem("authToken",e.data.token),u(e.data.token),c(e.data.user)}catch(e){let t="Registration failed. Please try again.";throw e instanceof a.MS?t=409===e.status?"An account with this email already exists.":400===e.status?"Please check your information and try again.":0===e.status?"Network error. Please check your connection.":e.message:e instanceof Error&&(t=e.message),m(t),Error(t)}finally{h(!1)}},v=async()=>{try{h(!0),s&&await (0,a.TX)(s)}catch(t){console.warn("Logout API call failed:",t)}finally{localStorage.removeItem("authToken"),u(null),c(null),h(!1)}},w=async()=>{if(s)try{let t=await (0,a.ts)(s);c(t)}catch(t){console.warn("Failed to refresh user data:",t),await v()}};return(0,o.jsx)(i.Provider,{value:{user:n,token:s,loading:l,isLoading:d,login:g,register:p,logout:v,clearError:()=>{m(null)},error:y,isAuthenticated:!!n&&!!s,refreshUser:w},children:e})}function s(){let t=(0,r.useContext)(i);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},634:function(t,e,n){"use strict";n.r(e),n.d(e,{LocationProvider:function(){return i},useLocation:function(){return c}});var o=n(7437),r=n(2265);let a=(0,r.createContext)(void 0);function i(t){let{children:e}=t,[n,i]=(0,r.useState)(null),[c,s]=(0,r.useState)(null),[u,l]=(0,r.useState)(null),[f,d]=(0,r.useState)("prompt"),[h,y]=(0,r.useState)(!1),[m,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!navigator.geolocation){d("unsupported"),g("Geolocation is not supported by this browser.");return}"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(t=>{d(t.state),t.onchange=()=>{d(t.state)}});let t=localStorage.getItem("userLocation");if(t)try{let e=JSON.parse(t);i(e.location),s(e.locationName),l(e.geocodedLocation)}catch(t){console.error("Error parsing saved location:",t)}},[]);let p=async(t,e)=>{try{let n=await fetch("https://api.opencagedata.com/geocode/v1/json?q=".concat(t,"+").concat(e,"&key=209d17df24024d31bdb7645501875d4c&language=en"));if(!n.ok)throw Error("Geocoding failed: ".concat(n.status));let o=await n.json();if(o.results&&o.results.length>0){let t=o.results[0],e=t.components;return{city:e.city||e.town||e.village,state:e.state,country:e.country,formatted:t.formatted}}throw Error("No geocoding results found")}catch(t){throw console.error("Geocoding error:",t),t}},v=async()=>{if(!navigator.geolocation){g("Geolocation is not supported by this browser.");return}y(!0),g(null);try{await w()}catch(t){g(t instanceof Error?t.message:"Failed to get location")}finally{y(!1)}},w=async()=>new Promise((t,e)=>{if(!navigator.geolocation){e(Error("Geolocation is not supported"));return}navigator.geolocation.getCurrentPosition(async n=>{try{let e={latitude:n.coords.latitude,longitude:n.coords.longitude,accuracy:n.coords.accuracy,timestamp:n.timestamp};i(e),d("granted");let o=await p(e.latitude,e.longitude);l(o);let r=o.city||o.formatted||"".concat(e.latitude.toFixed(4),", ").concat(e.longitude.toFixed(4));s(r),localStorage.setItem("userLocation",JSON.stringify({location:e,locationName:r,geocodedLocation:o})),t()}catch(t){e(t)}},t=>{let n="Failed to get location";switch(t.code){case t.PERMISSION_DENIED:n="Location permission denied",d("denied");break;case t.POSITION_UNAVAILABLE:n="Location information unavailable";break;case t.TIMEOUT:n="Location request timed out";break;default:n="Unknown location error"}g(n),e(Error(n))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e5})});return(0,o.jsx)(a.Provider,{value:{location:n,locationName:c,geocodedLocation:u,permissionStatus:f,isLoading:h,error:m,requestPermission:v,getCurrentLocation:w,clearLocation:()=>{i(null),s(null),l(null),localStorage.removeItem("userLocation")},geocodeLocation:p},children:e})}function c(){let t=(0,r.useContext)(a);if(void 0===t)throw Error("useLocation must be used within a LocationProvider");return t}},8877:function(){},7354:function(t){t.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c"}},8960:function(t){!function(){var e={229:function(t){var e,n,o,r=t.exports={};function a(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function c(t){if(e===setTimeout)return setTimeout(t,0);if((e===a||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:a}catch(t){e=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(t){n=i}}();var s=[],u=!1,l=-1;function f(){u&&o&&(u=!1,o.length?s=o.concat(s):l=-1,s.length&&d())}function d(){if(!u){var t=c(f);u=!0;for(var e=s.length;e;){for(o=s,s=[];++l<e;)o&&o[l].run();l=-1,e=s.length}o=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function y(){}r.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new h(t,e)),1!==s.length||u||c(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=y,r.addListener=y,r.once=y,r.off=y,r.removeListener=y,r.removeAllListeners=y,r.emit=y,r.prependListener=y,r.prependOnceListener=y,r.listeners=function(t){return[]},r.binding=function(t){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var a=n[t]={exports:{}},i=!0;try{e[t](a,a.exports,o),i=!1}finally{i&&delete n[t]}return a.exports}o.ab="//";var r=o(229);t.exports=r}()},622:function(t,e,n){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o=n(2265),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,c=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var o,a={},u=null,l=null;for(o in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(l=e.ref),e)i.call(e,o)&&!s.hasOwnProperty(o)&&(a[o]=e[o]);if(t&&t.defaultProps)for(o in e=t.defaultProps)void 0===a[o]&&(a[o]=e[o]);return{$$typeof:r,type:t,key:u,ref:l,props:a,_owner:c.current}}e.Fragment=a,e.jsx=u,e.jsxs=u},7437:function(t,e,n){"use strict";t.exports=n(622)}},function(t){t.O(0,[2971,7864,1744],function(){return t(t.s=6339)}),_N_E=t.O()}]);